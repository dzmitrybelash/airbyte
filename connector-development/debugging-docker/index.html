<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-connector-development/debugging-docker">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Debugging Docker Containers | Airbyte Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.airbyte.com/connector-development/debugging-docker"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Debugging Docker Containers | Airbyte Documentation"><meta data-rh="true" name="description" content="This guide will cover debugging JVM docker containers either started via Docker Compose or started by the"><meta data-rh="true" property="og:description" content="This guide will cover debugging JVM docker containers either started via Docker Compose or started by the"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.airbyte.com/connector-development/debugging-docker"><link data-rh="true" rel="alternate" href="https://docs.airbyte.com/connector-development/debugging-docker" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.airbyte.com/connector-development/debugging-docker" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OYKDBC51MU-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Airbyte Documentation" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.98c93e8f.css">
<link rel="preload" href="/assets/js/runtime~main.b8199571.js" as="script">
<link rel="preload" href="/assets/js/main.7b30ae4a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-dark.png" alt="Simple, secure and extensible data integration" class="themedImage_ToTc themedImage--light_HNdA" height="40" width="140"><img src="/img/logo-light.png" alt="Simple, secure and extensible data integration" class="themedImage_ToTc themedImage--dark_i4oU" height="40" width="140"></div><b class="navbar__title text--truncate"></b></a><a href="https://airbyte.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://status.airbyte.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://airbyte.com/tutorials" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Tutorials<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://support.airbyte.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://cloud.airbyte.io/signup?utm_campaign=22Q1_AirbyteCloudSignUpCampaign_Trial&amp;utm_source=Docs&amp;utm_content=NavBar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Try Airbyte Cloud<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Debugging Docker Containers</h1><p>This guide will cover debugging <strong>JVM docker containers</strong> either started via Docker Compose or started by the
worker container, such as a Destination container. This guide will assume use of <a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener noreferrer">IntelliJ Community edition</a>,
however the steps could be applied to another IDE or debugger.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">â€‹</a></h2><p>You should have the airbyte repo downloaded and should be able to <a href="https://docs.airbyte.com/deploying-airbyte/local-deployment" target="_blank" rel="noopener noreferrer">run the platform locally</a>.
Also, if you&#x27;re on macOS you will need to follow the installation steps for <a href="https://github.com/chipmk/docker-mac-net-connect" target="_blank" rel="noopener noreferrer">Docker Mac Connect</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-your-debugger">Connecting your debugger<a href="#connecting-your-debugger" class="hash-link" aria-label="Direct link to Connecting your debugger" title="Direct link to Connecting your debugger">â€‹</a></h2><p>This solution utilizes the environment variable <code>JAVA_TOOL_OPTIONS</code> which when set to a specific value allows us to connect our debugger.
We will also be setting up a <strong>Remote JVM Debug</strong> run configuration in IntelliJ which uses the IP address or hostname to connect.</p><blockquote><p><strong>Note</strong>
The <a href="https://github.com/chipmk/docker-mac-net-connect" target="_blank" rel="noopener noreferrer">Docker Mac Connect</a> tool is what makes it possible for macOS users to connect to a docker container
by IP address.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-compose-extension">Docker Compose Extension<a href="#docker-compose-extension" class="hash-link" aria-label="Direct link to Docker Compose Extension" title="Direct link to Docker Compose Extension">â€‹</a></h3><p>By default, the <code>docker compose</code> command will look for a <code>docker-compose.yaml</code> file in your directory and execute its instructions. However, you can
provide multiple files to the <code>docker compose</code> command with the <code>-f</code> option. You can read more about how Docker compose combines or overrides values when
you provide multiple files <a href="https://docs.docker.com/compose/extends/" target="_blank" rel="noopener noreferrer">on Docker&#x27;s Website</a>.</p><p>In the Airbyte repo, there is already another file <code>docker-compose.debug.yaml</code> which extends the <code>docker-compose.yaml</code> file. Our goal is to set the<br>
<code>JAVA_TOOL_OPTIONS</code> environment variable in the environment of the container we wish to debug. If you look at the <code>server</code> configuration under <code>services</code>
in the <code>docker-compose.debug.yaml</code> file, it should look like this:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> JAVA_TOOL_OPTIONS=$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">DEBUG_SERVER_JAVA_OPTIONS</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What this is saying is: For the Service <code>server</code> add an environment variable <code>JAVA_TOOL_OPTIONS</code> with the value of the variable <code>DEBUG_SERVER_JAVA_OPTIONS</code>.
<code>DEBUG_SERVER_JAVA_OPTIONS</code> has no default value, so if we don&#x27;t provide one, <code>JAVA_TOOL_OPTIONS</code> will be blank or empty. When running the <code>docker compose</code> command,
Docker will look to your local environment variables, to see if you have set a value for <code>DEBUG_SERVER_JAVA_OPTIONS</code> and copy that value. To set this value
you can either <code>export</code> the variable in your environment prior to running the <code>docker compose</code> command, or prepend the variable to the command. For our debugging purposes,
we want the value to be <code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:5005</code> so to connect our debugger to the <code>server</code> container, run the following:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">DEBUG_SERVER_JAVA_OPTIONS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:5005&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VERSION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;dev&quot;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> compose -f docker-compose.yaml -f docker-compose.debug.yaml up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Note</strong>
This command also passes in the <code>VERSION=dev</code> environment variable, which is recommended from the comments in the <code>docker-compose.debug.yaml</code></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-the-debugger">Connecting the Debugger<a href="#connecting-the-debugger" class="hash-link" aria-label="Direct link to Connecting the Debugger" title="Direct link to Connecting the Debugger">â€‹</a></h3><p>Now we need to connect our debugger. In IntelliJ, open <code>Edit Configurations...</code> from the run menu (Or search for <code>Edit Configurations</code> in the command palette).
Create a new <em>Remote JVM Debug</em> Run configuration. The <code>host</code> option defaults to <code>localhost</code> which if you&#x27;re on Linux you can leave this unchanged.
On a Mac however, you need to find the IP address of your container. <strong>Make sure you&#x27;ve installed and started the <a href="https://github.com/chipmk/docker-mac-net-connect" target="_blank" rel="noopener noreferrer">Docker Mac Connect</a>
service prior to running the <code>docker compose</code> command</strong>. With your containers running, run the following command to easily fetch the IP addresses:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> inspect </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">docker</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable function" style="color:#d73a49">ps</span><span class="token variable" style="color:#36acaa"> -q </span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> --format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{{ printf &quot;%-50s&quot; .Name}} {{printf &quot;%-50s&quot; .Config.Image}} {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-proxy                                     airbyte/proxy:dev                                  </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.10172.19.0.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-server                                    airbyte/server:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-worker                                    airbyte/worker:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-source                                    sha256:5eea76716a190d10fd866f5ac6498c8306382f55c6d910231d37a749ad305960 </span><span class="token number" style="color:#36acaa">172.17</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-connector-builder-server                  airbyte/connector-builder-server:dev               </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-webapp                                    airbyte/webapp:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-cron                                      airbyte/cron:dev                                   </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-temporal                                  airbyte/temporal:dev                               </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-db                                        airbyte/db:dev                                     </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.4172.19.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-temporal-ui                               temporalio/web:1.13.0                              </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.3172.19.0.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see an entry for <code>/airbyte-server</code> which is the container we&#x27;ve been targeting so copy its IP address (<code>172.18.0.9</code> in the example output above)
and replace <code>localhost</code> in your IntelliJ Run configuration with the IP address.</p><p>Save your Remote JVM Debug run configuration and run it with the debug option. You should now be able to place breakpoints in any code that is being executed by the
<code>server</code> container. If you need to debug another container from the original <code>docker-compose.yaml</code> file, you could modify the <code>docker-compose.debug.yaml</code> file with a similar option.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-containers-launched-by-the-worker-container">Debugging Containers Launched by the Worker container<a href="#debugging-containers-launched-by-the-worker-container" class="hash-link" aria-label="Direct link to Debugging Containers Launched by the Worker container" title="Direct link to Debugging Containers Launched by the Worker container">â€‹</a></h3><p>The Airbyte platform launches some containers as needed at runtime, which are not defined in the <code>docker-compose.yaml</code> file. These containers are the source or destination
tasks, among other things. But if we can&#x27;t pass environment variables to them through the <code>docker-compose.debug.yaml</code> file, then how can we set the
<code>JAVA_TOOL_OPTIONS</code> environment variable? Well, the answer is that we can <em>pass it through</em> the container which launches the other containers - the <code>worker</code> container.</p><p>For this example, lets say that we want to debug something that happens in the <code>destination-postgres</code> connector container. To follow along with this example, you will
need to have set up a connection which uses postgres as a destination, however if you want to use a different connector like <code>source-postgres</code>, <code>destination-bigquery</code>, etc. that&#x27;s fine.</p><p>In the <code>docker-compose.debug.yaml</code> file you should see an entry for the <code>worker</code> service which looks like this</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">worker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DEBUG_CONTAINER_IMAGE=$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">DEBUG_CONTAINER_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DEBUG_CONTAINER_JAVA_OPTS=</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agentlib</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">jdwp=transport=dt_socket</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">server=y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">suspend=y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">address=</span><span class="token important">*:</span><span class="token number" style="color:#36acaa">5005</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similar to the previous debugging example, we want to pass an environment variable to the <code>docker compose</code> command. This time we&#x27;re setting the
<code>DEBUG_CONTAINER_IMAGE</code> environment variable to the name of the container we&#x27;re targeting. For our example that is <code>destination-postgres</code> so run the command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">DEBUG_CONTAINER_IMAGE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;destination-postgres:5005&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">VERSION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;dev&quot;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> compose -f docker-compose.yaml -f docker-compose.debug.yaml up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>worker</code> container now has an environment variable <code>DEBUG_CONTAINER_IMAGE</code> with a value of <code>destination-postgres</code> which when it compares when it is
spawning containers. If the container name matches the environment variable, it will set the <code>JAVA_TOOL_OPTIONS</code> environment variable in the container to
the value of its <code>DEBUG_CONTAINER_JAVA_OPTS</code> environment variable, which is the same value we used in the <code>server</code> example.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-the-debugger-to-a-worker-spawned-container">Connecting the Debugger to a Worker Spawned Container<a href="#connecting-the-debugger-to-a-worker-spawned-container" class="hash-link" aria-label="Direct link to Connecting the Debugger to a Worker Spawned Container" title="Direct link to Connecting the Debugger to a Worker Spawned Container">â€‹</a></h4><p>To connect your debugger, <strong>the container must be running</strong>. This <code>destination-postgres</code> container will only run when we&#x27;re running one of its tasks,
such as when a replication is running. Navigate to a connection in your local Airbyte instance at http://localhost:8000 which uses postgres as a destination.
If you ran through the <a href="https://airbyte.com/tutorials/postgres-replication" target="_blank" rel="noopener noreferrer">Postgres to Postgres replication tutorial</a>, you can use this connection.</p><p>On the connection page, trigger a manual sync with the &quot;Sync now&quot; button. Because we set the <code>suspend</code> option to <code>y</code> in our <code>JAVA_TOOL_OPTIONS</code> the
container will pause all execution until the debugger is connected. This can be very useful for methods which run very quickly, such as the Check method.
However, this could be very detrimental if it were pushed into a production environment. For now, it gives us time to set a new Remote JVM Debug Configuraiton. </p><p>This container will have a different IP than the <code>server</code> Remote JVM Debug Run configuration we set up earlier. So lets set up a new one with the IP of
the <code>destination-postgres</code> container:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> inspect </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">docker</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable function" style="color:#d73a49">ps</span><span class="token variable" style="color:#36acaa"> -q </span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> --format</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{{ printf &quot;%-50s&quot; .Name}} {{printf &quot;%-50s&quot; .Config.Image}} {{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/destination-postgres-write-52-0-grbsw             airbyte/destination-postgres:0.3.26                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-proxy                                     airbyte/proxy:dev                                  </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.10172.19.0.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-worker                                    airbyte/worker:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-server                                    airbyte/server:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-destination                               postgres                                           </span><span class="token number" style="color:#36acaa">172.17</span><span class="token plain">.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-source                                    sha256:5eea76716a190d10fd866f5ac6498c8306382f55c6d910231d37a749ad305960 </span><span class="token number" style="color:#36acaa">172.17</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-connector-builder-server                  airbyte/connector-builder-server:dev               </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-webapp                                    airbyte/webapp:dev                                 </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-cron                                      airbyte/cron:dev                                   </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-temporal                                  airbyte/temporal:dev                               </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-db                                        airbyte/db:dev                                     </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.2172.19.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/airbyte-temporal-ui                               temporalio/web:1.13.0                              </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.4172.19.0.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Huh? No IP address, weird. Interestingly enough, all the IPs are sequential but there is one missing, <code>172.18.0.1</code>. If we attempt to use that IP in remote debugger, it works!</p><p>You can now add breakpoints and debug any code which would be executed in the <code>destination-postgres</code> container.</p><p>Happy Debugging!</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-the-debugger-to-an-integration-test-spawned-container">Connecting the Debugger to an Integration Test Spawned Container<a href="#connecting-the-debugger-to-an-integration-test-spawned-container" class="hash-link" aria-label="Direct link to Connecting the Debugger to an Integration Test Spawned Container" title="Direct link to Connecting the Debugger to an Integration Test Spawned Container">â€‹</a></h4><p>You can also debug code contained in containers spawned in an integration test! This can be used to debug integration tests as well as testing code changes.
The steps involved are: </p><ol><li>Follow all the steps outlined above to set up the <strong>Remote JVM Debug</strong> run configuration.</li><li>Edit the run configurations associated with the given integration test with the following environment variables:<code>DEBUG_CONTAINER_IMAGE=source-postgres;DEBUG_CONTAINER_JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=*:5005</code>
Note that you will have to keep repeating this step for every new integration test run configuration you create. </li><li>Run the integration test in debug mode. In the debug tab, open up the Remote JVM Debugger run configuration you just created. </li><li>Keep trying to attach the Remote JVM Debugger. It will likely fail a couple of times and eventually connect to the test container. If you want a more
deterministic way to connect the debugger, you can set a break point in the <code>DockerProcessFactor.localDebuggingOptions()</code> method. Resume running the integration test run and
then attempt to attach the Remote JVM Debugger (you still might need a couple of tries).</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gotchas">Gotchas<a href="#gotchas" class="hash-link" aria-label="Direct link to Gotchas" title="Direct link to Gotchas">â€‹</a></h2><p>So now that your debugger is set up, what else is there to know?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-changes">Code changes<a href="#code-changes" class="hash-link" aria-label="Direct link to Code changes" title="Direct link to Code changes">â€‹</a></h3><p>When you&#x27;re debugging, you might want to make a code change. Anytime you make a code change, your code will become out of sync with the container which is run by the platform.
Essentially this means that after you&#x27;ve made a change you will need to rebuild the docker container you&#x27;re debugging. Additionally, for the connector containers, you may have to navigate to
&quot;Settings&quot; in your local Airbyte Platform&#x27;s web UI and change the version of the container to <code>dev</code>. See you connector&#x27;s <code>README</code> for details on how to rebuild the container image.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ports">Ports<a href="#ports" class="hash-link" aria-label="Direct link to Ports" title="Direct link to Ports">â€‹</a></h3><p>In this tutorial we&#x27;ve been using port <code>5005</code> for all debugging. It&#x27;s the default, so we haven&#x27;t changed it. If you need to debug <em>multiple</em> containers however, they will clash on this port.
If you need to do this, you will have to modify your setup to use another port that is not in use.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/airbytehq/airbyte/blob/master/docs/../docs/connector-development/debugging-docker.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#connecting-your-debugger" class="table-of-contents__link toc-highlight">Connecting your debugger</a><ul><li><a href="#docker-compose-extension" class="table-of-contents__link toc-highlight">Docker Compose Extension</a></li><li><a href="#connecting-the-debugger" class="table-of-contents__link toc-highlight">Connecting the Debugger</a></li><li><a href="#debugging-containers-launched-by-the-worker-container" class="table-of-contents__link toc-highlight">Debugging Containers Launched by the Worker container</a></li></ul></li><li><a href="#gotchas" class="table-of-contents__link toc-highlight">Gotchas</a><ul><li><a href="#code-changes" class="table-of-contents__link toc-highlight">Code changes</a></li><li><a href="#ports" class="table-of-contents__link toc-highlight">Ports</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.b8199571.js"></script>
<script src="/assets/js/main.7b30ae4a.js"></script>
</body>
</html>